# 푼 방법

angr로 하려 하였으나 엄청 느렸고 따라서 z3py로 포팅해서 돌리니까 나왔습니다.

단 랜덤 값 생성 루틴은 상당히 복잡한 부분이 있었기 때문에 해당 ARM 코드를 QEMU로 직접 돌려서 rand()값만 엄청 뽑아서 4바이트 단위로 저장해놓고 불러오는 방식으로 처리했습니다.

뭔가 IO가 임베디드에서 하는것같이 되어있었기 때문에 ELF로 패킹하고 해당 코드를 0x10000에 매핑한 다음 IO함수들을 제가 작성한 함수들로 패치하는 방법을 썼습니다. 지금의 코드가 돌아가는 데 딱히 상관은 없습니다. rand()만 뽑았기 때문입니다.

ELF 베이스도 0x10000이라서 바꿔줬습니다.